---
layout: post
title: "引用"
author: "ZJM"
categories: code/algorithm/basic-knowledge
tags: [Code]
image: code-cover-8.png
---

# <span style="color: rgb(255,127,80);">**引用**</span>

在 C++ 中，**引用**是一种为变量提供别名的机制。引用不仅可以用来传递参数，还可以作为返回值。引用通常比指针更容易理解和使用，它使得代码更加简洁，并减少了指针的复杂性。本文将详细介绍 C++ 中引用的基本概念、作为函数参数和返回值的应用以及使用引用时的注意事项。

#### <span style="color: rgb(0,191,255);">**C++ 中的引用基本概念**</span>

引用是某个变量的别名。引用在初始化时与某个变量绑定，并且从此之后，它就成为这个变量的别名。可以使用引用来访问和修改原始变量的值。

##### <span style="color: rgb(32,178,170);">**1. 创建引用**</span> 

在 C++ 中，引用的声明方式是在类型名后加上 `&` 符号。举个例子：

```cpp
int i = 17;
int& r = i;  // r 是 i 的引用
```

此时，`r` 和 `i` 指向同一个内存位置，修改 `r` 或 `i` 都会影响到对方。

#### <span style="color: rgb(32,178,170);">**2. 引用与指针的区别**</span> 

引用与指针在 C++ 中有几个明显的不同之处：

- **引用不能为 null**：一旦引用被初始化，它就必须绑定到一个合法的内存位置，而指针可以指向 `nullptr`。
- **引用不能更改指向对象**：引用一旦绑定到某个变量，它就不能再指向其他变量，而指针可以随时指向不同的对象。
- **引用必须在创建时初始化**：创建引用时必须提供一个变量来初始化它，而指针则可以在任何时候被初始化。

这些特点使得引用在某些情况下比指针更加安全和简洁。

#### <span style="color: rgb(0,191,255);">**引用作为函数参数**</span>

C++ 中，引用经常用于函数参数传递。这种方式称为**引用传递**。引用传递的一个主要优点是，函数能够直接修改传入的变量，而无需返回任何值或通过指针修改。相比传值传递，引用传递避免了复制变量的开销。

##### <span style="color: rgb(32,178,170);">**示例：交换两个整数的值**</span> 

以下是一个简单的例子，演示如何通过引用传递来交换两个整数的值：

```cpp
#include <iostream>
using namespace std;
// 函数声明
void swap(int& x, int& y);
int main()
{
    int a = 100;
    int b = 200;
    cout << "交换前，a 的值：" << a << endl;
    cout << "交换前，b 的值：" << b << endl;
    // 调用函数交换值
    swap(a, b);
    cout << "交换后，a 的值：" << a << endl;
    cout << "交换后，b 的值：" << b << endl;

    return 0;
}
// 函数定义：通过引用交换两个整数的值
void swap(int& x, int& y)
{
    int temp = x; // 保存 x 的值
    x = y;        // 将 y 的值赋给 x
    y = temp;     // 将 x 的值赋给 y
}
```

<span style="color: rgb(238,130,238);">**输出结果：**</span>

```yaml
交换前，a 的值：100
交换前，b 的值：200
交换后，a 的值：200
交换后，b 的值：100
```

在上面的例子中，`swap` 函数通过引用传递，直接修改了 `a` 和 `b` 的值，而不需要使用指针或者返回值。

#### <span style="color: rgb(0,191,255);">**引用作为函数返回值**</span>

除了作为函数参数，引用也可以作为函数的返回值。在 C++ 中，返回一个引用可以让你直接修改函数返回的对象，而不需要通过指针来进行操作。

##### <span style="color: rgb(32,178,170);">**示例：返回数组元素的引用**</span> 

以下是一个示例，演示如何通过返回引用来修改数组中的元素：

```cpp
#include <iostream>
using namespace std;
double vals[] = {10.1, 12.6, 33.1, 24.1, 50.0};
// 函数返回数组元素的引用
double& setValues(int i)
{  
    double& ref = vals[i];  // 创建对数组元素的引用
    return ref;  // 返回该引用
}
int main()
{
    cout << "改变前的值" << endl;
    for (int i = 0; i < 5; i++)
    {
        cout << "vals[" << i << "] = " << vals[i] << endl;
    }
    // 调用函数修改数组中的元素
    setValues(1) = 20.23;  // 改变第 2 个元素
    setValues(3) = 70.8;   // 改变第 4 个元素
    cout << "改变后的值" << endl;
    for (int i = 0; i < 5; i++)
    {
        cout << "vals[" << i << "] = " << vals[i] << endl;
    }
    return 0;
}
```

<span style="color: rgb(238,130,238);">**输出结果：**</span>

```yaml
改变前的值
vals[0] = 10.1
vals[1] = 12.6
vals[2] = 33.1
vals[3] = 24.1
vals[4] = 50
改变后的值
vals[0] = 10.1
vals[1] = 20.23
vals[2] = 33.1
vals[3] = 70.8
vals[4] = 50
```

在这个示例中，`setValues` 函数返回了 `vals[i]` 的引用，从而允许我们直接修改数组中的元素。

##### <span style="color: rgb(0,191,255);">**注意事项：不要返回局部变量的引用**</span>

需要特别注意的是，不能返回一个局部变量的引用，因为局部变量在函数结束时会被销毁，返回该变量的引用将导致未定义行为。相反，如果函数返回静态变量的引用，静态变量在程序的生命周期内保持有效。

##### <span style="color: rgb(32,178,170);">**示例：返回静态变量的引用**</span> 

```cpp
#include <iostream>
using namespace std;
int& getStaticRef()
{
    static int num = 5;  // 静态变量
    return num;  // 返回静态变量的引用
}
int main()
{
    int& ref = getStaticRef();  // 获取对静态变量的引用
    cout << "初始值：" << ref << endl;
    ref = 10;  // 修改静态变量的值
    cout << "修改后的值：" << ref << endl;
    cout << "再次调用函数后的值：" << getStaticRef() << endl;
    return 0;
}
```

<span style="color: rgb(238,130,238);">**输出结果：**</span>

```yaml
初始值：5
修改后的值：10
再次调用函数后的值：10
```

### <span style="color: rgb(0,191,255);">**总结**</span>

- **引用的基本概念**：引用是变量的别名，通过引用可以修改原始变量的值，避免了指针的复杂性。
- **引用作为参数**：引用传递允许函数直接修改传入的变量，并且避免了值传递的复制开销。
- **引用作为返回值**：函数返回引用可以让我们直接修改返回值对应的对象。需要注意，不能返回局部变量的引用，但可以返回静态变量的引用。

通过灵活使用引用，C++ 编程可以变得更加简洁、高效，同时提高代码的可读性和可维护性。